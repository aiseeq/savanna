# Дизайн-документ: Симулятор экосистемы саванны

## Концепция игры

### Жанр
Песочница с симуляцией экосистемы, где игрок создаёт и наблюдает за развитием собственных видов животных в африканской саванне.

### Основная идея
Игрок изучает живую экосистему, экспериментирует с созданием новых видов животных и наблюдает, как они взаимодействуют с окружающей средой. Прогрессия через систему достижений открывает новые возможности для создания более сложных существ.

### Целевая платформа
Десктопное приложение на Go с использованием Ebitengine.

## Геймплей

### Основной игровой цикл
1. **Наблюдение**: Игрок изучает сгенерированную экосистему саванны
2. **Создание**: Дизайн нового вида животного с доступными параметрами и перками
3. **Выпуск**: Размещение животных на карте (ограничено маной)
4. **Эксперимент**: Наблюдение за взаимодействием с экосистемой
5. **Прогресс**: Получение достижений и разблокировка новых возможностей

### Управление
- Скролл мыши: масштабирование от общего вида до детального
- ЛКМ: выбор и информация о животном
- ПКМ: перемещение камеры
- Пробел: пауза/ускорение времени
- Tab: переключение между режимами просмотра и создания

## Технические характеристики

### Визуальный стиль
- Изометрическая проекция в стиле StarCraft 1
- 2D спрайты для всех объектов
- Круглые "мягкие" юниты с механикой распихивания
- AI-генерированные спрайты животных

### Анимации
- **Idle** - стояние на месте
- **Walk** - медленное передвижение
- **Run** - быстрый бег
- **Eat** - поедание пищи
- **Attack** - атака
- **Sleep** - сон/отдых
- **Die** - смерть
- **Breed** - размножение (сердечки)

### Производительность
- Поддержка тысяч юнитов на больших картах
- LOD для спрайтов: полный → упрощённый → точка
- Детерминированные автоматы для всех животных
- Параллельные вычисления по секторам карты

### Временная модель
- 1 игровой год = 5-10 минут реального времени
- Сезонные изменения (температура, осадки, миграции)
- День/ночь отложены на будущие версии

## Экосистема

### Карта
- Процедурная генерация
- Масштабируемый размер (ограничен железом игрока)
- Элементы ландшафта:
  - Водоёмы (озёра, реки)
  - Растительность:
    - Трава (злаковые) - основной корм травоядных
    - Деревья (акации) - верхушки для высоких травоядных
    - Кусты - укрытия для мелких животных, препятствия для крупных
  - Рельеф (холмы с увеличенным обзором)
  - Скалы (непроходимые препятствия)

### Пищевые цепи
- Солнечная энергия → растительность → травоядные → хищники
- Рост растений зависит от влажности и температуры
- Типы растительной пищи: трава, листья кустов, верхушки деревьев
- Ограничения хищников по размеру добычи

### Энергетический баланс
- Закон сохранения энергии в экосистеме
- Естественное ограничение популяций через доступные ресурсы

## Создание животных

### Явные параметры (настраиваемые за очки)
- Размер/вес
- Скорость передвижения
- Продолжительность жизни
- Метаболизм
- Сила (для хищников)
- Броня (защита от хищников)

### Неявные параметры (вычисляемые)
- **Хиты** - зависят от размера, возраста, продолжительности жизни, метаболизма
- **Заметность** - зависит от размера, скорости движения, перков
- **Выносливость** - зависит от метаболизма и возраста
- **Радиус обзора** - зависит от размера и положения (холмы)

### Динамические параметры
- **Сытость** (0-100%):
  - Влияет на скорость (низкая или слишком высокая снижают)
  - Определяет возможность размножения
  - Влияет на регенерацию хитов
- **Здоровье** (текущие хиты):
  - Потеря хитов снижает все параметры пропорционально
  - Медленно восстанавливается во время сна при высокой сытости
- **Возраст** (0 - макс):
  - Молодые: сниженные параметры, быстрый рост
  - Взрослые: пик всех характеристик
  - Старые: постепенное снижение всех параметров

### Система перков

#### MVP перки
1. **Травоядное** - питается растительностью
2. **Хищник** - питается другими животными

#### Базовые перки (первая волна)
3. **Всеядное** - комбинация травоядного и хищника
4. **Стадное/Стайное** - группируется с сородичами
5. **Пират** - крадёт чужую добычу
6. **Камуфляж** - маскировка в определённой растительности
7. **Плавающее** - может пересекать водоёмы
8. **Лазающее** - может забираться на деревья

#### Продвинутые перки (требуют разблокировки)
9. **Летающее** - птицы (несовместимо с бронёй)
10. **Бронированное** - усиленная защита (снижает скорость)
11. **Падальщик** - питается мертвечиной
12. **Ночное** - активно ночью (для будущих версий)

### Размножение
- Требования: сытость + безопасность
- Визуализация: сердечки над головами
- Потомство:
  - Наследует все базовые характеристики вида
  - Небольшой псевдорандом для вариативности (±5%)
  - Финальный размер взрослой особи зависит от питания в период роста
  - Возможен адаптивный дрейф параметров (экспериментально)

## Прогрессия

### Мана
- Ресурс для создания животных
- Восстанавливается со временем
- Предотвращает читерство массовым спавном

### Достижения

#### Начальные
- "Первые шаги": создать вид с популяцией 10+ особей
- "Выживание": пережить первую засуху
- "Охотник": ваш хищник успешно поохотился 10 раз

#### Промежуточные  
- "Доминирование": занять 10% биомассы экосистемы
- "Эволюция": вытеснить один из стартовых видов
- "Стойкость": сохранить стадо 30+ особей в течение года

#### Продвинутые
- "Апекс-хищник": стать единственным видом хищников
- "Травоядная империя": 50% всей биомассы
- "Армагеддон": уничтожить всю экосистему

### Разблокировки
- Новые перки привязаны к достижениям
- Поздние достижения открывают катаклизмы (засухи, пожары)
- Глобальный прогресс сохраняется между картами

## План разработки

### MVP (Минимально играбельный продукт)
1. Статичная карта с постоянным ростом травы
2. Два вида: условные "заяц" и "волк"
3. Базовые параметры без перков
4. Простейший UI для создания животных
5. Наблюдение и базовая статистика

### Версия 0.2
- Добавить перк "всеядное"
- Процедурная генерация карты
- Водоёмы и их влияние
- Первые 3-5 достижений

### Версия 0.3
- Сезонность и миграции
- Перки: стадное, плавающее, камуфляж
- Расширенная статистика и графики
- 10+ достижений

### Версия 0.4
- Полная система перков
- Все типы ландшафта
- Сохранение/загрузка
- Экспорт/импорт видов

### Версия 1.0
- Балансировка всех систем
- 30+ достижений
- Оверлеи и продвинутая визуализация
- Катаклизмы для поздней игры

## Технические решения

### Архитектура
- ECS (Entity Component System) для животных
- Квадродерево для оптимизации коллизий
- Секторная система для параллелизации
- Детерминированная симуляция для воспроизводимости

### Система движения
- **Прямая линия** - основной способ движения при отсутствии препятствий
- **Векторы притяжения/отталкивания**:
  - Притяжение к пище, воде, сородичам
  - Отталкивание от хищников, препятствий
- **Ограниченный обзор** - планирование только в радиусе видимости
- **"Чутьё"** - градиентный вектор к удалённым целям (вода, добыча)
- Простой обход препятствий без сложного pathfinding

### Детерминированность
- Единое зерно генерации для всей симуляции
- Воспроизводимость всех событий при одинаковых действиях
- Поддержка записи и воспроизведения реплеев
- Упрощение отладки и тестирования

### Форматы данных
- JSON для сохранений и конфигов
- Base64 для экспорта видов
- PNG для спрайтов

### Моддинг (отложено)
- Lua для кастомного поведения
- Поддержка пользовательских спрайтов
- Steam Workshop интеграция

## Вдохновение и референсы
- StarCraft 1 - визуальный стиль и управление
- Master of Orion 2 - система создания рас
- Настольная игра "Эволюция" - перки и взаимодействия
- Crusader Kings 2 - песочница без явной цели

## Открытые вопросы для итераций
1. Порядок добавления новых животных после MVP
2. Приоритеты перков по импакту на геймплей
3. Баланс между реализмом и fan-фактором
4. Оптимальная скорость восстановления маны
5. Визуальные эффекты для разных состояний животных

## Идеи для будущих версий
- Критический урон и статус кровотечения
- Следы крови как визуальный элемент
- День/ночь с соответствующими изменениями поведения
- Продвинутые территориальные механики
- Болезни и паразиты как фактор популяции
- Более сложные социальные взаимодействия
